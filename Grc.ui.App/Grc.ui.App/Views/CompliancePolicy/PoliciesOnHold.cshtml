@model PolicyDashboardModel

@{
    Layout = "_Layout";
    ViewData["Title"] = "ON HOLD";

    var chartsJson = JsonSerializer.Serialize(Model);
}

<div class="welcome-container">

    <div class="welcome-container-message">
        <span class="display-1">@Model.WelcomeMessage</span>
    </div>

    <div class="incon-container-expand">
        <button id="expandBtn" type="button" class="icon-btn">
            <span>
                <i id="toggleIcon" class="mdi mdi-arrow-expand"></i>
            </span>
        </button>
    </div>

</div>

<div class="action-box">
    <div class="title-box">
        <h3 class="display-1 action-box-title">@Html.Raw(ILocalize.GetLocalizedLabel("App.Menu.Dashboard.Labels.Quick"))</h3>
        <span class="title-line"></span>
    </div>

    @await Component.InvokeAsync("QuickActions", new { model = Model.QuickActions })

</div>

<div class="dashboard-category-grid m-3">

    <div class="stats-category-grid" id="policyCards"></div>

    <div class="dashboard-bottom-row" style="display:flex; gap:20px; margin-top:30px;">
        <!-- Left: Pie chart of categories -->
        <div class="category-chart-container" style="flex:1">
            <div class="chart-card-title">Department Policies on Hold</div>
            <canvas id="unitPieChart"></canvas>
        </div>

        <!-- Right: Table of processes -->
        <div class="category-chart-container" style="flex:1">
            <div id="processTable"></div>
        </div>

    </div>

</div>

<div id="polOverlay" class="obligation-panel-overlay"></div>

<div id="polPanel" class="obligation-side-panel" onclick="event.stopPropagation()">

    <div class="collapse-panel-header">
        <h3 id="panelTitle">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.PolRegister.Header"))</h3>
        <button class="panel-close" onclick="closePolPanel()">
            <i class="mdi mdi-close"></i>
        </button>
    </div>

    <div class="collapse-panel-body">

        <form id="recordForm" class="grc-form row g-3">
            <div class="row g-3">

                <!-- document Name -->
                <div class="col-6">

                    <div class="row mb-3">
                        <label for="documentName" class="col-sm-12 col-form-label text-sm-start">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Name"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="documentName" name="documentName" class="form-control" readonly />
                        </div>
                    </div>

                </div>

                <div class="col-6">
                    <div class="row mb-3">
                        <label for="documentTypeName" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Type"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="documentTypeName" name="documentTypeName" class="form-control" readonly />
                        </div>
                    </div>

                </div>

                <div class="col-6">
                    <div class="row mb-3">
                        <label for="departmentName" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Department"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="departmentName" name="departmentName" class="form-control" readonly />
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="row mb-3">
                        <label for="responsibilityName" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Responsible"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="responsibilityName" name="responsibilityName" class="form-control" readonly />
                        </div>
                    </div>
                </div>

                <!-- Last review Date -->
                <div class="col-6">
                    <div class="row mb-3">
                        <label for="lastReview" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Task.LastDate"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="lastReview" name="lastReview" class="form-control" readonly />
                        </div>
                    </div>
                </div>

                <!-- Next review Date -->
                <div class="col-6">
                    <div class="row mb-3">
                        <label for="nextReview" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Task.NextDate"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="nextReview" name="nextReview" class="form-control" readonly />
                        </div>
                    </div>
                </div>

                <!-- Frequency -->
                <div class="col-6">
                    <div class="row mb-3">
                        <label for="frequencyName" class="col-sm-12 col-form-label">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Select.Frequency"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="frequencyName" name="frequencyName" class="form-control" readonly />
                        </div>
                    </div>
                </div>

                <!-- Review Status -->
                <div class="col-6">

                    <div class="row mb-3">
                        <label for="documentStatus" class="col-sm-12 col-form-label text-sm-end">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Procedure.Status"))
                        </label>
                        <div class="col-sm-12">
                            <input type="text" id="documentStatus" name="documentStatus" class="form-control" readonly />
                        </div>
                    </div>

                </div>

                <div class="col-12">
                    <!-- description -->
                    <div class="row mb-3">
                        <label for="comments" class="col-sm-12 col-form-label text-sm-start">
                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Policy.Description"))
                        </label>
                        <div class="col-sm-12">
                            <textarea id="comments" name="comments" class="form-control" rows="3" readonly></textarea>
                        </div>
                    </div>

                </div>

            </div>

            <div class="col-sm-12">
                <div class="row mb-3">
                    <div class="col-sm-2">
                        <button type="button" class="btn btn-grc-secondary" onclick="closePolPanel()">Close</button>
                    </div>
                    <div class="col-sm-10"></div>
                </div>
            </div>

        </form>

    </div>

</div>

@{
    Html.AddScriptParts(ResourceLocation.Footer, "~/js/policy-status-dashboard-script.js");
}

<script>
    const policyData = @Html.Raw(chartsJson);
    const cardColor = "card-unit-default";
    const cardClass = "card-onhold";
    const cardBg = "#F59E0B";
</script>