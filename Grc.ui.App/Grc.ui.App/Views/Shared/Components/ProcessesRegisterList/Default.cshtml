@model OperationProcessViewModel

<div class="grc-tabulator-container">

    <div class="grc-tabulator-search">

        <div class="field-search-group">
            <label class="form-searchbox-label text-right">
                @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Search.Processes"))
            </label>
            <input id="processesSearchbox" type="text" class="form-control searchbox-field">
        </div>

        <div class="field-search-buttons">
            <button id="btnExportProcess" class="btn btn-primary">
                <i class="mdi mdi-file-excel-outline"></i> @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.ExportFiltered"))
            </button>
        </div>

    </div>

    <div id="processRegisterTable"></div>

</div>

<!-- Overlay -->
<div class="process-overlay" onclick="closeProcessPanel()">

    <!-- Slide Panel -->
    <div id="collapsePanel" class="collapse-panel" onclick="event.stopPropagation()">

        <div class="collapse-panel-header">
            <h3 id="processPanelTitle">Process</h3>
            <button class="collapse-panel-close" onclick="closeProcessPanel()">&times;</button>
        </div>

        <div class="collapse-panel-body">

            <form id="processForm" class="grc-form row g-3">
                <input type="hidden" id="processId">
                <input type="hidden" id="isEdit">

                <!-- Basic Information Section -->
                <div class="form-section">

                    <div class="section-header" onclick="toggleSection(this)">
                        <h5>@Html.Raw(ILocalize.GetLocalizedLabel("Component.Process.CollapsablePane.Basic"))</h5>
                        <span class="section-toggle">
                            <i class="mdi mdi-menu-down"></i>
                        </span>
                    </div>

                    <div class="section-content expanded">

                        <div class="section-body">

                            <div class="row g-3">

                                <div class="col-6">
                                    
                                    <div class="row mt-2">
                                        <label for="processName" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Name"))
                                        </label>
                                        <div class="col-sm-12">
                                            <input type="text" id="processName" name="processName" class="form-control">
                                       </div>
                                    </div>

                                </div>

                                <div class="col-6">
                                    <div class="row mb-3">
                                        <label for="typeId" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Type"))
                                        </label>
                                        <div class="col-sm-12">
                                            <select class="form-select" id="typeId" name="typeId"
                                                    aria-labelledby="typeId-label"
                                                    aria-describedby="typeId-description">
                                                <option value="0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Type.Select"))</option>
                                                @if (Model?.ProcessTypes != null && Model.ProcessTypes.Any())
                                                {
                                                    foreach (var type in Model.ProcessTypes)
                                                    {
                                                        <option value="@type.Id">@type.TypeName</option>
                                                    }
                                                }
                                            </select>

                                            <span id="typeId-description" class="sr-only">
                                                @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.srOnly.ArrowKeys"))
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="row mt-2">
                                        <label for="processDescription" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Description"))
                                        </label>
                                        <div class="col-sm-12">
                                            <textarea id="processDescription" name="processDescription" class="form-control" rows="3"></textarea>
                                       </div>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="row mb-3">
                                        <label for="processStatus" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Status"))
                                        </label>
                                        <div class="col-sm-12">
                                            <select class="form-select" id="processStatus" name="processStatus" aria-labelledby="processStatus-label" aria-describedby="processStatus-description">
                                                <option value="0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Status.Select"))</option>
                                                @if (Model?.ProcessStatuses != null && Model.ProcessStatuses.Any())
                                                {
                                                    foreach (var status in Model.ProcessStatuses)
                                                    {
                                                        <option value="@status.Id">@status.StatusName</option>
                                                    }
                                                }
                                            </select>

                                            <span id="processStatus-description" class="sr-only">
                                                @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.srOnly.ArrowKeys"))
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div id="IsDeletedBox" class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="isDeleted">
                                        <label class="form-check-label" for="isDeleted">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.IsDeleted"))
                                        </label>
                                    </div>
                                </div>

                                <div id="lockProcess" class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="isLockProcess">
                                        <label class="form-check-label" for="isLockProcess">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Process.Lock"))
                                        </label>
                                    </div>
                                </div>

                                <div id="onHoldBox" class="col-12">
                                    <div class="row mb-3">
                                        <label for="onholdReason" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.onholdReason"))
                                        </label>
                                        <div class="col-sm-12">
                                            <textarea id="onholdReason" name="onholdReason" class="form-control" rows="3"></textarea>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-12">
                                    <div class="row mb-3">
                                        <label for="comment" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Comments"))
                                        </label>
                                        <div class="col-sm-12">
                                            <textarea id="comment" name="comment" class="form-control" rows="3"></textarea>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <!-- Process File Section -->
                <div class="form-section">

                    <div class="section-header" onclick="toggleSection(this)">
                        <h5>@Html.Raw(ILocalize.GetLocalizedLabel("Component.Process.CollapsablePane.File"))</h5>
                        <span class="section-toggle">
                            <i class="mdi mdi-menu-down"></i>
                        </span>
                    </div>

                    <div class="section-content">

                        <div class="section-body">

                            <div class="row g-3">

                                <div class="col-6">

                                    <div class="row mb-3">
                                        <label for="fileName" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.FileName"))
                                        </label>
                                        <div class="col-sm-12">
                                            <input type="text" id="fileName" name="fileName" class="form-control">
                                        </div>
                                    </div>

                                </div>

                                <div class="col-6">

                                    <div class="row mb-3">
                                        <label for="fileVersion" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.FileVersion"))
                                        </label>
                                        <div class="col-sm-12">
                                            <input type="text" id="fileVersion" name="fileVersion" class="form-control">
                                        </div>
                                    </div>

                                </div>

                                <div class="col-12">
                                    <div class="row mb-3">
                                        <div class="col-12">
                                            <ul id="fileList" class="list-unstyled mt-3"></ul>
                                            <div id="dropZone" class="grc-file-drop">
                                                <i class="mdi mdi-cloud-arrow-up-outline fs-1 text-muted"></i>
                                                <p class="mt-2 mb-0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.FileDrag"))</p>
                                                <input type="file" id="fileInput" multiple style="position: absolute; left: -9999px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <!-- Responsibility Section -->
                <div class="form-section">

                    <div class="section-header" onclick="toggleSection(this)">
                        <h5>@Html.Raw(ILocalize.GetLocalizedLabel("Component.Process.CollapsablePane.Owenership"))</h5>
                        <span class="section-toggle">
                            <i class="mdi mdi-menu-down"></i>
                        </span>
                    </div>

                    <div class="section-content">

                        <div class="section-body">

                            <div class="row g-3">

                                <div class="col-6">
                                    <div class="row mb-3">
                                        <label for="unitId" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Unit"))
                                        </label>
                                        <div class="col-sm-12">
                                            <select class="form-select" id="unitId" name="unitId" aria-labelledby="unitId-label" aria-describedby="unitId-description">
                                                <option value="0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Unit.Select"))</option>
                                                @if (Model?.Units != null && Model.Units.Any())
                                                {
                                                    foreach (var unit in Model.Units)
                                                    {
                                                        <option value="@unit.Id">@unit.UnitName</option>
                                                    }
                                                }
                                            </select>

                                            <span id="unitId-description" class="sr-only">
                                                @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.srOnly.ArrowKeys"))
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-6"></div>

                                <div class="col-6">
                                    <div class="row mb-3">
                                        <label for="ownerId" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Owner"))
                                        </label>
                                        <div class="col-sm-12">
                                            <select class="form-select" id="ownerId" name="ownerId" aria-labelledby="ownerId-label" aria-describedby="ownerId-description">
                                                <option value="0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Owner.Select"))</option>
                                                @if (Model?.Responsibilities != null && Model.Responsibilities.Any())
                                                {
                                                    foreach (var owmer in Model.Responsibilities)
                                                    {
                                                        <option value="@owmer.Id">@owmer.ResponsibleRole</option>
                                                    }
                                                }
                                            </select>

                                            <span id="ownerId-description" class="sr-only">
                                                @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.srOnly.ArrowKeys"))
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="row mb-3">
                                        <label for="assigneedId" class="col-sm-12 form-label">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Responsible"))
                                        </label>
                                        <div class="col-sm-12">
                                            <select class="form-select" id="assigneedId" name="assigneedId" aria-labelledby="assigneedId-label" aria-describedby="assigneedId-description">
                                                <option value="0">@Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Responsible.Select"))</option>
                                                @if (Model?.Responsibilities != null && Model.Responsibilities.Any())
                                                {
                                                    foreach (var manager in Model.Responsibilities)
                                                    {
                                                        <option value="@manager.Id">@manager.ResponsibleRole</option>
                                                    }
                                                }
                                            </select>

                                            <span id="assigneedId-description" class="sr-only">
                                                @Html.Raw(ILocalize.GetLocalizedLabel("App.Label.srOnly.ArrowKeys"))
                                            </span>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <!-- other approvers Section -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <h5>@Html.Raw(ILocalize.GetLocalizedLabel("Component.Process.CollapsablePane.AdditionalReview"))</h5>
                        <span class="section-toggle">
                            <i class="mdi mdi-menu-down"></i>
                        </span>
                    </div>
                    <div class="section-content">

                        <div class="section-body">

                            <div class="row g-3">

                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="needsBranchOperations">
                                        <label class="form-check-label" for="needsBranchOperations">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.BranchOPerationsReview"))
                                        </label>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="needsCreditReview">
                                        <label class="form-check-label" for="needsCreditReview">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.NeedsCreditReview"))
                                        </label>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="needsTreasuryReview">
                                        <label class="form-check-label" for="needsTreasuryReview">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.NeedsTreasuryReview"))
                                        </label>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="needsFintechReview">
                                        <label class="form-check-label" for="needsFintechReview">
                                            @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.NeedsFintechReview"))
                                        </label>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>

                <!-- Button section -->
                <div class="col-sm-12">
                    <div class="row mb-3">
                        <div class="col-sm-1">
                            <button class="btn btn-grc-primary" style="width:100%;" onclick="saveProcessRecord(event)">@Html.Raw(ILocalize.GetLocalizedLabel("Button.Submit"))</button>
                        </div>
                        <div class="col-sm-1">
                            <button class="btn btn-grc-secondary" style="width:100%;" onclick="closeProcessPanel()">@Html.Raw(ILocalize.GetLocalizedLabel("Button.Cancel"))</button>
                        </div>
                        <div class="col-sm-10"></div>
                    </div>
                </div>

            </form>

        </div>

    </div>

</div>

<!-- Overlay -->
<div class="initiate-overlay" onclick="closeInitiatePanel()">

    <!-- Slide Panel -->
    <div id="initiatePanel" class="initiate-panel" onclick="event.stopPropagation()">

        <div class="initiate-panel-header">
            <h3 id="initiatePanelTitle">@Html.Raw(ILocalize.GetLocalizedLabel("App.Processes.Initiate.Title"))</h3>
            <button class="initiate-panel-close" onclick="closeInitiatePanel()">&times;</button>
        </div>

        <div class="initiate-panel-body">

            <form id="initiateForm" class="grc-form row g-3">
                <input type="hidden" id="initiateId">

                <div class="alert alert-warning">
                    <span class="alert-msg">
                        @Html.Raw(ILocalize.GetLocalizedLabel("App.Processes.Initiate.Warning"))
                    </span>
                </div>
                
                <div class="col-12">

                    <div class="row">

                        <div class="col-6">

                            <div class="row mb-3">
                                <label for="initiateName" class="col-sm-12 form-label">
                                    @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Name"))
                                </label>
                                <div class="col-sm-12">
                                    <input type="text" id="initiateName" name="initiateName" class="form-control" readonly>
                                </div>
                            </div>

                        </div>

                        <div class="col-6">

                            <div class="row mt-2">
                                <label for="initiateDescription" class="col-sm-12 form-label">
                                    @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Process.Description"))
                                </label>
                                <div class="col-sm-12">
                                    <textarea id="initiateDescription" name="initiateDescription" class="form-control" rows="3" readonly></textarea>
                                </div>
                            </div>

                        </div>

                        <div class="col-12">
                            <div class="row mt-2">
                                <label for="unlockReason" class="col-sm-12 form-label">
                                    @Html.Raw(ILocalize.GetLocalizedLabel("Component.Table.Initiate.Process"))
                                </label>
                                <div class="col-sm-12">
                                    <textarea id="unlockReason" name="unlockReason" class="form-control" rows="3"></textarea>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

                <!-- Button section -->
                <div class="col-sm-12">
                    <div class="row mb-3">
                        <div class="col-sm-1">
                            <button class="btn btn-grc-primary" style="width:100%;" onclick="initiateProcessReview(event)">@Html.Raw(ILocalize.GetLocalizedLabel("Button.Submit"))</button>
                        </div>
                        <div class="col-sm-1">
                            <button class="btn btn-grc-secondary" style="width:100%;" onclick="closeInitiatePanel()">@Html.Raw(ILocalize.GetLocalizedLabel("Button.Cancel"))</button>
                        </div>
                        <div class="col-sm-10"></div>
                    </div>
                </div>

            </form>

        </div>
    </div>

</div>

@{
    Html.AddScriptParts(ResourceLocation.Footer, "~/lib/jquery/dist/jquery.js");
    Html.AddScriptParts(ResourceLocation.Footer, "~/js/app-process-register.js");
}
