@using System.Text.Json
@model UnitExtensionModel
@{
    Layout = "_OperationLayout";
    ViewData["Title"] = "CASH PROCESSES";

    var chartsJson = JsonSerializer.Serialize(Model);
}

<div class="welcome-container">
    <div class="welcome-container-message">
        <span class="display-1">@Model.WelcomeMessage</span>
    </div>
    <div class="incon-container-expand">
        <button id="expandBtn" type="button" class="icon-btn">
            <span>
                <i id="toggleIcon" class="mdi mdi-arrow-expand"></i>
            </span>
        </button>
    </div>

</div>

<div class="action-box">
    <div class="title-box">
        <h3 class="display-1 action-box-title">QUICK ACTIONS</h3>
        <span class="title-line"></span>
    </div>

    <div class="quick-actions">
        <a href="/operations/dashboard">
            <span><i class="mdi mdi-home"></i></span>
            <span>Home</span>
        </a>
        @await Component.InvokeAsync("QuickActions", new { model = Model.QuickActions })
    </div>
</div>

<div class="dashboard-category-grid">

    <!-- Category total Cards -->
    <div class="stats-category-grid" id="unitCards">
        <!-- Cards will be generated here -->
    </div>

    <div class="dashboard-bottom-row" style="display:flex; gap:20px; margin-top:30px;">

        <!-- Left: Pie chart of categories -->
        <div class="category-chart-container" style="flex:1">
            <div class="chart-card-title">Category Distribution</div>
            <canvas id="unitPieChart"></canvas>
        </div>

        <!-- Right: Table of processes -->
        <div class="category-chart-container" style="flex:1">
            <div class="chart-card-title">Processes per Category</div>
            <table class="table is-fullwidth is-striped" id="processTable">
                <thead>
                    <tr>
                        <th>CATEGORY NAME</th>
                        <th>PROCESS COUNT</th>
                        <th>MORE</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

@{
    Html.AddScriptParts(ResourceLocation.Footer, "~/js/operations-units-dashboard-script.js");
}

<script>
    const unitStatistics = @Html.Raw(chartsJson);
    const cardColor = "card-unit-default";
</script>